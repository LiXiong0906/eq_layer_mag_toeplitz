\section{Application to field data}

We applied the convolutional equivalent layer method to the aeromagnetic data of Carajás, 
northern Brazil.
The survey is composed of $131$ flight lines along north-south direction with line spacing of 
$\Delta y = 3,000$ m. 
Data were measured with average spacing $\Delta x = 7.65$ m along lines,
with an average distance to the ground of $900$ m. 
The total number of observation points is $N = 6,081,345$. Figure \ref{fig:carajas_residuals_comparison}a
shows the observed total-field anomaly data over the study area.

We compare the results obtained with an interpolated regular grid of $10,000 \times 131$ points, 
by using the nearest neighbor algorithm, and a decimated irregular grid, also with $10,000 \times 131$
points. In both cases the total $N = 1,310,000$ observation points are in the original undulating surface of the flight lines. 
The decimated grid was generated by 
choosing the nearest observation points in comparison of the regular grid presented in the interpolation.
The mean and standard deviation of this irregular decimated from the regular interpolated are $6.8386$ m and $107.7343$ m in the $x$-direction and $30.8799$ m and $28.3849$ m in the $y$-direction, respectively.
Both application were made with an Intel core i7 7700HQ@2.8GHz processor in single-processing and 
single-threading modes. 

As the study area is very large, the main magnetic field varies with position.
For this application, we set the main field direction as that of a mid location 
(latitude $-6.5^{\circ}$ and longitude $-50.75^{\circ}$) where the declination is $-19.86^{\circ}$ and
the inclination is $-7.4391^{\circ}$. Both values were calculated using the magnetic field calculator from NOAA
at 1st January, 2014 (epoch of the survey). We set the equivalent layer at $300$ meters above the ground ($600$ m below the data).
Figure \ref{fig:carajas_residuals_comparison}b shows the residuals obtained after using our method to fit
the interpolated data with mean $0.0762$ nT and the standard deviation  $0.4886$ nT, revealing an acceptable data fitting. Our method took $\approx 390.80$ seconds to converge at about $200$ iterations.
Figure \ref{fig:carajas_residuals_comparison}c shows the residuals obtained after using our method to fit
the decimated data with mean $0.0717$ nT and standard deviation 
$0.3144$ nT with a better fit than the produced by the interpolated data. In this case, our method took $\approx 385.56$ seconds to converge at about $200$ iterations (Figure \ref{fig:carajas_residuals_comparison}d). 
The convergence curve reveals a good convergence rate obtained with the decimated 
irregular grid. This result shows the robustness of our method in processing irregular grid. Notice that we used $200$ iterations in our method of the interpolated regular grid and the mean residual still decreasing up to $2000$. This happens because the invariance convergence criterion was met as the mean residuals are very small and each iteration decreases less than $0.00001$

With $1,310,000$ observation points, it would be necessary $12.49$ Terabytes of RAM to store the full
sensitivity matrix with the classical method. 
In this case, our method uses only $59.97$ Megabytes, allowing regular desktop computers to be able 
to process this amount of data.


%
%\textbf{Alternative text} $\rightarrow$
%
%As the study area is very large, the main magnetic field varies with position.
%For this application, we set the main field direction as that of a mid location 
%(latitude $-6.5^{\circ}$ and longitude $-50.75^{\circ}$) where the declination is $-19.86^{\circ}$ 
%and inclination is $XXXXXX^{\circ}$ according to IGRF model at 1st January, 2014 (epoch of the survey).
%(É ESTRANHO CALCULAR A DECLINAÇÃO COM UM MODELO E A INCLINAÇÃO COM OUTRO)
%
%$\leftarrow$ \textbf{Alternative text}
%

%(Figure \ref{fig:carajas_real_data_decimated_gridline}a), we obtain the  predicted data shown in 
%Figure \ref{fig:carajas_gz_predito_mag_gridline}a and data residuals 
%(Figure \ref{fig:carajas_gz_predito_mag_gridline}b) with mean $0.0762$ nT and the standard deviation 
%$0.4886$ nT, revealing an acceptable data fitting.
%Our method took $\approx 390.80$ seconds to converge at about $200$ iterations.
%
%POR QUE A CURVA DE CONVERGENCIA NÃO FOI MOSTRADA?
%

%By applying our method to the decimated irregular grid 
%(Figure \ref{fig:carajas_real_data_decimated_gridline}b), we obtain the predicted data shown in 
%Figure \ref{fig:carajas_gz_predito_mag_decimated}a and data residuals 
%(Figure \ref{fig:carajas_gz_predito_mag_decimated}b) with mean $0.0717$ nT and standard deviation 
%$0.3144$ nT. In this case, our method took $\approx 385.56$ seconds 
%to converge at about $200$ iterations (Figure \ref{fig:convergence_carajas_mag_decimated}).
%(TEM ALGO ESTRANHO AQUI. COMO QUE 2000 ITERAÇÕES FOI MAIS MAIS RÁPIDO DO QUE AS 200 ITERAÇÕES DO GRID INTERPOLADO?).

%The convergence curve reveals a good convergence rate obtained with the decimated 
%irregular grid. This result shows the robustness of our method in processing irregular grid. Notice that we used in our %method of the interpolated regular grid $200$ iterations and the mean residual still decreasing up to $2000$. This happens %because the invariance convergence criterion was met as the mean residuals are very small and each iteration decreases less %than $0.00001$

%We have found, in applying our method to the decimated irregular grid, that the data residual amplitude (Figure \ref{fig:carajas_gz_predito_mag_decimated}b) is lower than the data residual amplitude (Figure 
%\ref{fig:carajas_gz_predito_mag_gridline}b) obtained by applying our method to the interpolated regular grid.
%It occurs because  the  process of decimating the original irregularly data creates neither new observation points nor new data. Rather, the interpolation of the original irregularly data creates either new observation points or new data. 

Finally, Figure \ref{fig:carajas_upward_comparison}a shows the upward-continued magnetic data to a
horizontal plane located at an altitude of $5, \,000$ m using the estimated equivalent layer obtained by applying our
method to the decimated irregular grid. This process took $\approx 2.64$ seconds, showing good results 
without visible errors or border effects. 
Figure \ref{fig:carajas_upward_comparison}b shows the upward-continued magnetic data to a
horizontal plane located at an altitude of $5, \,000$ m using the classical Fourier filtering method to the decimated irregular grid.
This process took $\approx 0.5$ seconds. Altough, no border effect could be observed, this result showed unexpected high values instead of the expected attenuation of the anomalies. We stress that we did not use a padding scheme to expand the data.