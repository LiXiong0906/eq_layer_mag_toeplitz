\section{Application to field data}

To evaluate the performance of the convolution equivalent layer proposed in this paper, we applied it to the aeromagnetic data of Caraj√°s, northern Brazil, provided by CPRM.
The survey is composed of $131$ flight lines along north-south direction with line spacing of 
$\Delta y = 3,000$ m. 
The magnetometer (Scintrex CS-3) was set to an interval between measurements of $0.1$ s giving a spacing $\Delta x = 7.65$ m. The average flight heigth is $900$ m. The total number of observation points is $N = 6,081,345$. Figure \ref{fig:carajas_real_data_mag} shows the observed magnetic field data over the area.

We compare the results using an interpolated regular grid of $10,000 \times 131$, by using the nearest neighbour algorithm, with a decimated irregular grid, also of $10,000 \times 131$, totaling $N = 1,310,000$ observation points in both cases. 
Figure \ref{fig:carajas_real_data_decimated_gridline}a and \ref{fig:carajas_real_data_decimated_gridline}b shows the results, respectively, of the interpolation and of the decimation. 
With $1,310,000$ observation points, it would be necessary $12.49$ Terabytes of RAM to store the full sensitivity matrix with the classical approach. 
However, taking advantage that the second derivatives of equation \ref{eq:r} are symmetric or skew-symmetric matrices, our method allows to reconstruct the whole sensitivity matrix storing only the first column of each component of equation \ref{eq:Hi}, thus, using only $59.97$ Megabytes, allowing desktop computers to be able to process this amount of data.

As this area is very large, different values of the magnetic main field can be considered. 
For this processing, it was considered an approximated mid location of the area (latitude $-6.5^{\circ}$ and longitude $-50.75^{\circ}$) where the declination is $-19.86^{\circ}$ for the IGRF model in 1st january, 2014. The inclination was calculated using the magnetic field calculator from NOAA and is equal to $-7.4391^{\circ}$. 

We set the equivalent layer at $300$ meters above the ground.
By applying our method to the interpolated regular grid 
(Figure \ref{fig:carajas_real_data_decimated_gridline}a), we obtain the  predicted data 
(Figure \ref{fig:carajas_gz_predito_mag_gridline}a) and its data residuals 
(Figure \ref{fig:carajas_gz_predito_mag_gridline}b), with mean of $0.0762$ nT and the standart deviation of $0.4886$ nT  revealing an acceptable data fitting.
Our method converges at about 200 iterations,  taking $390.80$ seconds with a Intel core i7 7700HQ@2.8GHz processor in single-processing and single-threading modes. 

By applying our method to the decimated iregular grid 
(Figure \ref{fig:carajas_real_data_decimated_gridline}b), we  obtain the  predicted data 
(Figure \ref{fig:carajas_gz_predito_mag_decimated}a) and its data residuals 
(Figure \ref{fig:carajas_gz_predito_mag_decimated}b), with mean of  of $0.0717$ nT and standart deviation of $0.3144$ nT. This application took $385.56$ seconds to complete the estimative.
Figure \ref{fig:convergence_carajas_mag_decimated} shows the convergence curve, up to $2,000$ iterations, revealing a good convergence rate by applying our method to the decimated irregular grid. 
This result shows the  robustness of our method in processing irregular grid.

We have found, in applying our method to the decimated irregular grid, that the data residual amplitude (Figure \ref{fig:carajas_gz_predito_mag_decimated}b) is lower than the data residual amplitude (Figure 
\ref{fig:carajas_gz_predito_mag_gridline}b) obtained by applying our method to the interpolated regular grid.
It occurs because  the  process of decimating the original irregularly data creates neither new observation points nor new data. Rather, the interpolation of the original irregularly data creates either new observation points or new data. 

Figure \ref{fig:up5000_carajas_decimated_mag} shows the upward-continued magnetic data  to a horizontal plane located at $5, \,000$ m using the estimated equivalent layer obtained by applying our method to the decimated irregular grid (Figure \ref{fig:carajas_real_data_decimated_gridline}b).
This process took $2.64$ seconds, showing good results without visible errors or border effects and accentuating the long wavelenghts.