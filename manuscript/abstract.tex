\begin{abstract}

We present a fast equivalent layer method for processing large-scale magnetic data. 
We demonstrate that the sensitivity matrix associated with an equivalent layer
of dipoles can be arranged to a Block-Toeplitz Toeplitz-Block (BTTB) structure for the 
case in which observations and dipoles are aligned on a 
horizontal and regularly-spaced grid.
The product of a BTTB matrix and an arbitrary vector represents a discrete 
convolution and can be efficiently computed via 2D Fast Fourier Transform.
In this case, the matrix-vector product uses only the elements forming the first column
of the BTTB matrix, saving computational time and memory. 
Our convolutional equivalent layer method uses this approach to compute 
the matrix-vector products in the iterative conjugate gradient algorithm with the purpose 
of estimating the physical-property distribution over the equivalent layer for 
large data sets.
Synthetic tests with a mid-size $100 \times 50$ grid of total-field anomaly data
show a decrease of $\approx 10^4$ in floating-point operations and $\approx 25\times$ 
in computation runtime of our method compared to the classical approach of solving
the least-squares normal equations via Cholesky decomposition. 
Faster results are obtained for millions of data, showing drastic decreases in RAM usage
and runtime, allowing to perform magnetic data processing of large data sets on regular 
desktop computers. 
Our results also show that, compared to the classical Fourier approach, the magnetic
data processing with our method requires similar computation time, but produces significantly 
smaller border effects without using any padding scheme and also is more robust to 
deal with data on irregularly spaced points or on undulating observation surfaces.
A test with $1,310,000$ irregularly spaced field data over the Caraj{\'a}s Province, Brazil, 
confirms the efficiency of our method by taking $\approx 385.56$ seconds to estimate the physical-property
distribution over the equivalent layer and $\approx 2.64$ seconds to compute the upward 
continuation.

\end{abstract}