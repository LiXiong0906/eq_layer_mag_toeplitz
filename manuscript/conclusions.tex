\section{Conclusions}

We have proposed  a fast convolutional equivalent-layer technique for processing magnetic data 
whose computation time is more than four orders of magnitude less than the classical equivalent layer.
Mathematically, we have  demonstrated that the sensitivity matrix associated with the linear system of the magnetic equivalent layer carries the structure of BTTB matrices, which means not only a very low computational cost to calculate a matrix-vector product, but also the possibility to store only the first column of the matrix BCCB. 
In this work, our novel fast convolutional equivalent-layer technique  uses only one equivalent source to calculate the first six columns of the inverse of distance second derivatives matrices and to set up the first column of the BCCB matrix embbeded from the original magnetic kernel sensitivity matrix.
We solve the linear system by adapting the method of Conjugate Gradient Least Square to compute fastly the BTTB matrix-vector product of the magnetic forward modeling in the equivalent-layer technique.

The comparisons between the performances of classical equivalent-layer technique  and  fast convolutional equivalent-layer technique using synthetic magnetic data show similar estimates of the physical-property distribution over the equivalent layer.
The difference in time, however, is noticeable: $2.04$ seconds using the classical approach and $0.083$ seconds using our approach. This difference was obtained with a mid-size mesh of $100 \times 50$ points, greater results can be obtained if more observation points are used.

The comparisons between the performances of classical approach in the Fourier domain and fast convolutional equivalent-layer technique for processing synthetic magnetic data show that the computational time required by the classical Fourier approach is the lowest one.
However, the classical Fourier approach requires not only expanding the data by using a padding function to avoid the border effects but also it requires the measurement of the data on a regular grid and on a planar observation surface.
Although the fast convolutional equivalent-layer technique  also requires that the data be measure on a regular grid and the observation surface be planar, the synthetic tests show the robustness of our method to deal  either with irregular grids or with uneven observation surface.
This robustness of our method may fail if the horizontal coordinates of the observations are greatly scattered
or if the observation surface is rugged.
However, a poor performance of our method  can be easily detected  because it leads to poor data fitting and the decay of the data-misfit function along the iterations (convergence curve) does not exhibit an invariance along successive iterations. 

On an irregular grid totaling $1,310,000$ observation points, the field data over the Caraj√°s Province, northern Brazil, would require $12.49$ Terabytes of RAM to store the full sensitivity matrix  to run the classical equivalent-layer technique. 
However, the fast convolutional equivalent-layer technique  neither requires the full computation nor the storage of a sensitivity matrix.
Taking advantage of the symmetric or skew-symmetric matrices structures, it is possible to reconstruct the whole sensitivity matrix using only $59.97$ Megabytes.
When performed on a standard laptop computer with an Intel Core i7 7700HQ@2.8GHz processor in single-processing and single-threading modes, the total time spent by our method for estimating the physical-property distribution over the equivalent layer was approximately $385.56$ seconds and for upward-continuing the total of $1,310,000$ magnetic observations  was $2.64$ seconds.

