\section{Conclusions}

We have proposed a fast equivalent-layer technique for processing magnetic data called
convolutional equivalent layer method.
We have demonstrated that the sensitivity matrix associated with planar 
equivalent layers of dipoles has a BTTB structure for the particular case in which 
the dipoles are aligned with the horizontal and regular grid of magnetic data.
The product of such matrices and arbitrary vectors represents a 2D discrete convolution
that can be efficiently computed via 2D Fast Fourier Transform by using only the 
elements forming the first column of the matrix.
By using this property, we have developed a fast and memory efficient iterative method for 
estimating the physical-property distribution on the equivalent layer.

Comparisons between the estimated physical-property distribution obtained with our method and 
the classical approach that solves the least-squares normal equations via Cholesky decomposition 
show similar results. 
The differences in total number of floating-point operations (flops), memory usage and computation 
time, however, are noticeable. 
For a mid-size grid of $100 \times 50$ points, the total number of flops is about four orders of
magnitude smaller than that required by the classical method. Besides, our method uses
less than $1\%$ of the RAM and takes about $3\%$ of the computation time associated with
the classical method in this case. % (TEM QUE CHECAR ESTAS VALORES)
Significantly better results can be obtained with larger data sets.

Tests with synthetic data show that the computational time required by our method has 
the same order of magnitude of that required by the classical approach in the Fourier domain
to perform magnetic data processing.
However, the classical Fourier approach shows considerable larger border effects if no previous 
padding scheme is used to expand the data. 
Besides, although both methods require the magnetic data be on a planar and regular grid, 
tests with synthetic data show the robustness of our method to deal with data either on irregular grids
or on undulating observation surfaces.

While the classical equivalent-layer method would require $12.49$ Terabytes of RAM to store the full
sensitivity matrix associated with the irregular grid of $1,310,000$ observation points over the
Carajás Province, northern Brazil, our method requires only $59.97$ Megabytes.
When performed on a standard laptop computer with an Intel Core i7 7700HQ@2.8GHz processor in
single-processing and single-threading modes, the total times spent by our method to estimate the
physical-property distribution over the equivalent layer and to compute the upward continuation
of the $1,310,000$ magnetic observations over the Carajás province was approximately $385.56$ 
seconds and $2.64$ seconds.

Further investigation could usefully explore different preconditioning strategies to improve the
convergence rate of our method. Besides, considerably more work will need to be done to generalize
our convolutional equivalent layer method for dealing with irregularly spaced data sets on 
undulating observation surfaces.


